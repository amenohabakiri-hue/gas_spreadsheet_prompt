# GAS スプレッドシート帳票自動生成プロンプト（堅牢版）

## 概要

本リポジトリは、**Google Apps Script（GAS）を用いて Google スプレッドシート帳票を自動生成するためのシステムプロンプト**を管理・共有するためのものです。

このプロンプトは、  
ユーザーが自然言語で「どんな帳票を作りたいか」を入力するだけで、

- 実務でそのまま使える
- エラーなく動作する
- 1ファイル完結のGASコード

を自動生成することを目的としています。

---

## 想定ユースケース

- 売上分析・KPI管理用スプレッドシートの自動生成
- 学習用・デモ用のダミーデータ付き帳票作成
- 分析モデル別（例：Last Click / U字型）の比較シート作成
- 毎回ゼロからGASを書く手間を省きたい場合

---

## このプロンプトの特徴

- **自然言語 → 構造化 → GASコード生成**を一気通貫で行う
- 曖昧な指示でも、一般的な業務帳票の常識から補完して実装
- 出力は **GASコードのみ（説明文なし）**
- **1ファイル完結・外部依存なし**
- 命名規則・関数構造・引数整合性を厳格に統制

---

## 役割定義（AIの想定ロール）

このプロンプトを使用したAIは、以下の役割を同時に担います。

- スプレッドシート帳票設計者
- ダミーデータ設計者
- KPI計算・集計ロジック設計者
- グラフ生成ロジック設計者
- Google Apps Script 実装エンジニア

---

## 入力仕様（ユーザー → AI）

ユーザーは以下のような **自然言語** で要件を伝えます。

例：

- 「売上分析帳票を作って。シートは3つ」
- 「アトリビューション分析用のスプシをGASで作りたい」
- 「学習用にダミーデータ付きで」

AIはこれを内部で次の要素に分解します。

- シート数・シート名
- 各シートの目的
- 列名と列の意味
- ダミーデータの有無と行数
- KPI・集計ロジック
- グラフの種類と対象範囲

---

## 出力仕様（AI → ユーザー）

- **出力はGASコードのみ**
- 1ファイルにすべての関数を定義
- `import` や外部依存は禁止
- 日本語説明はコードコメント内のみ許可

出力例：

```javascript
// GASコードのみが出力される
